{"ast":null,"code":"var _jsxFileName = \"/Users/daivo/Desktop/lab2-airbnb/data236-lab1-frontend/src/traveler/pastTrips.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useState, useMemo } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction fmtDateISOToLocal(s) {\n  if (!s) return \"\";\n  const d = new Date(s);\n  return d.toLocaleDateString(undefined, {\n    year: \"numeric\",\n    month: \"short\",\n    day: \"numeric\"\n  });\n}\nfunction diffNightsISO(startISO, endISO) {\n  if (!startISO || !endISO) return 0;\n  const a = new Date(startISO);\n  const b = new Date(endISO);\n  const ms = b.setHours(0, 0, 0, 0) - a.setHours(0, 0, 0, 0);\n  return Math.max(0, Math.round(ms / (1000 * 60 * 60 * 24)));\n}\nfunction toTitleCaseStatus(s) {\n  const map = {\n    PENDING: \"Pending\",\n    ACCEPTED: \"Accepted\",\n    CANCELLED: \"Cancelled\"\n  };\n  return map[String(s || \"\").toUpperCase()] || \"Pending\";\n}\nfunction statusClass(s) {\n  switch (s) {\n    case \"Accepted\":\n      return \"badge text-bg-success\";\n    case \"Cancelled\":\n      return \"badge text-bg-secondary\";\n    case \"Pending\":\n      return \"badge text-bg-warning\";\n    default:\n      return \"badge text-bg-light\";\n  }\n}\nfunction firstImage(photo_urls) {\n  if (!Array.isArray(photo_urls) || !photo_urls.length) return null;\n  const first = photo_urls[0];\n  return typeof first === \"string\" ? first : (first === null || first === void 0 ? void 0 : first.url) || null;\n}\nfunction imgSrc(url) {\n  if (!url) return \"https://via.placeholder.com/640x400?text=No+photo\";\n  return /^https?:\\/\\//i.test(url) ? url : `http://localhost:4000${url.startsWith(\"/\") ? url : `/${url}`}`;\n}\nfunction canCancel(status, checkinISO) {\n  const s = String(status);\n  if (s === \"Pending\") return true;\n  if (s === \"Accepted\") {\n    const today = new Date();\n    today.setHours(0, 0, 0, 0);\n    const cin = new Date(checkinISO);\n    cin.setHours(0, 0, 0, 0);\n    return cin > today;\n  }\n  return false;\n}\nasync function fetchJSON(url, opts = {}, {\n  onAuthFail\n} = {}) {\n  const res = await fetch(url, {\n    credentials: \"include\",\n    ...opts\n  });\n  if (res.status === 401 || res.status === 403) {\n    try {\n      localStorage.setItem(\"showLogin\", \"1\");\n    } catch {}\n    if (onAuthFail) onAuthFail();\n    throw new Error(\"Unauthorized\");\n  }\n  if (!res.ok) {\n    const data = await res.json().catch(() => ({}));\n    throw new Error(data.error || `Request failed (${res.status})`);\n  }\n  return res.json();\n}\nexport default function PastTrips() {\n  _s();\n  const nav = useNavigate();\n  const [items, setItems] = useState([]); // normalized bookings\n  const [loading, setLoading] = useState(true);\n  const [err, setErr] = useState(\"\");\n  const [busy, setBusy] = useState({}); // { [bookingId]: true }\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const bookingsData = await fetchJSON(\"http://localhost:4000/api/traveler/bookings\", {}, {\n          onAuthFail: () => nav(\"/\")\n        });\n        const rows = Array.isArray(bookingsData) ? bookingsData : Array.isArray(bookingsData === null || bookingsData === void 0 ? void 0 : bookingsData.bookings) ? bookingsData.bookings : bookingsData ? [bookingsData] : [];\n        const enriched = await Promise.all(rows.map(async b => {\n          var _prop;\n          let prop = null;\n          try {\n            const p = await fetchJSON(`http://localhost:4000/api/properties/${b.property_id}`, {}, {\n              onAuthFail: () => nav(\"/\")\n            });\n            prop = {\n              id: p.id,\n              name: p.title || \"Listing\",\n              price_per_night: p.price_per_night != null ? Number(p.price_per_night) : null,\n              image: firstImage(p.photo_urls)\n            };\n          } catch (_) {}\n          const nights = diffNightsISO(b.start_date, b.end_date);\n          const price = ((_prop = prop) === null || _prop === void 0 ? void 0 : _prop.price_per_night) || 0;\n          const subtotal = nights * price;\n          const taxes = Math.round(subtotal * 0.0975 * 100) / 100;\n          const total = Math.round((subtotal + taxes) * 100) / 100;\n          return {\n            id: b.id,\n            property_id: b.property_id,\n            status: toTitleCaseStatus(b.status),\n            checkin: b.start_date,\n            checkout: b.end_date,\n            guests: Number(b.guests || 1),\n            nights,\n            total,\n            property: prop\n          };\n        }));\n        setItems(enriched);\n      } catch (e) {\n        setErr(e.message || \"Failed to load bookings\");\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, [nav]);\n  const hasTrips = useMemo(() => items.length > 0, [items]);\n  async function cancelBooking(id) {\n    setBusy(m => ({\n      ...m,\n      [id]: true\n    }));\n    const prev = items;\n    // optimistic UI\n    setItems(list => list.map(b => b.id === id ? {\n      ...b,\n      status: \"Cancelled\"\n    } : b));\n    try {\n      await fetchJSON(`http://localhost:4000/api/traveler/bookings/${id}/cancel`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }, {\n        onAuthFail: () => nav(\"/\")\n      });\n    } catch (e) {\n      // rollback\n      setItems(prev);\n      alert(e.message || \"Cancel failed\");\n    } finally {\n      setBusy(m => {\n        const cpy = {\n          ...m\n        };\n        delete cpy[id];\n        return cpy;\n      });\n    }\n  }\n  if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"text-muted\",\n    children: \"Loading trips\\u2026\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 160,\n    columnNumber: 23\n  }, this);\n  if (err) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"alert alert-danger\",\n    children: err\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 161,\n    columnNumber: 19\n  }, this);\n  if (!hasTrips) return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"text-center p-5 border rounded-4 bg-light-subtle\",\n    children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n      className: \"mb-2\",\n      children: \"No trips yet\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"text-muted mb-3\",\n      children: \"When you take a trip, it\\u2019ll appear here.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Link, {\n      className: \"btn btn-dark rounded-pill px-4\",\n      to: \"/\",\n      children: \"Start exploring\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 164,\n    columnNumber: 7\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"vstack gap-3\",\n    children: items.map(b => {\n      const p = b.property || {};\n      const img = imgSrc(p.image);\n      const cancellable = canCancel(b.status, b.checkin);\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card border-0 shadow-sm rounded-4\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-body\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"row g-3 align-items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-auto\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: img,\n                alt: p.name,\n                width: \"96\",\n                height: \"96\",\n                className: \"rounded-3\",\n                style: {\n                  objectFit: \"cover\"\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 182,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"d-flex align-items-center gap-2 flex-wrap\",\n                children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n                  className: \"mb-0\",\n                  children: p.name || \"Listing\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 194,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: statusClass(b.status),\n                  children: b.status\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 195,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 193,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-muted small mt-1\",\n                children: [fmtDateISOToLocal(b.checkin), \" \\u2013 \", fmtDateISOToLocal(b.checkout), \" · \", b.nights, \" night\", b.nights > 1 ? \"s\" : \"\", \" · \", b.guests, \" guest\", b.guests > 1 ? \"s\" : \"\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 197,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col-auto text-end\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"fw-semibold\",\n                children: [\"$\", b.total.toFixed(2)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 207,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"text-muted small\",\n                children: \"Total\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 208,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mt-2 d-flex gap-2 justify-content-end\",\n                children: [/*#__PURE__*/_jsxDEV(Link, {\n                  className: \"btn btn-outline-secondary btn-sm rounded-pill\",\n                  to: `/property/${p.id}`,\n                  children: \"View place\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 210,\n                  columnNumber: 21\n                }, this), cancellable && /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn btn-outline-danger btn-sm rounded-pill\",\n                  disabled: !!busy[b.id],\n                  onClick: () => cancelBooking(b.id),\n                  children: busy[b.id] ? \"Cancelling…\" : \"Cancel\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 218,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 209,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 206,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 13\n        }, this)\n      }, b.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 11\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 172,\n    columnNumber: 5\n  }, this);\n}\n_s(PastTrips, \"oGq+B5+cs9kv2wOdSKR9aCh5E9M=\", false, function () {\n  return [useNavigate];\n});\n_c = PastTrips;\nvar _c;\n$RefreshReg$(_c, \"PastTrips\");","map":{"version":3,"names":["useEffect","useState","useMemo","Link","useNavigate","jsxDEV","_jsxDEV","fmtDateISOToLocal","s","d","Date","toLocaleDateString","undefined","year","month","day","diffNightsISO","startISO","endISO","a","b","ms","setHours","Math","max","round","toTitleCaseStatus","map","PENDING","ACCEPTED","CANCELLED","String","toUpperCase","statusClass","firstImage","photo_urls","Array","isArray","length","first","url","imgSrc","test","startsWith","canCancel","status","checkinISO","today","cin","fetchJSON","opts","onAuthFail","res","fetch","credentials","localStorage","setItem","Error","ok","data","json","catch","error","PastTrips","_s","nav","items","setItems","loading","setLoading","err","setErr","busy","setBusy","bookingsData","rows","bookings","enriched","Promise","all","_prop","prop","p","property_id","id","name","title","price_per_night","Number","image","_","nights","start_date","end_date","price","subtotal","taxes","total","checkin","checkout","guests","property","e","message","hasTrips","cancelBooking","m","prev","list","method","headers","alert","cpy","className","children","fileName","_jsxFileName","lineNumber","columnNumber","to","img","cancellable","src","alt","width","height","style","objectFit","toFixed","disabled","onClick","_c","$RefreshReg$"],"sources":["/Users/daivo/Desktop/lab2-airbnb/data236-lab1-frontend/src/traveler/pastTrips.jsx"],"sourcesContent":["import { useEffect, useState, useMemo } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\n\nfunction fmtDateISOToLocal(s) {\n  if (!s) return \"\";\n  const d = new Date(s);\n  return d.toLocaleDateString(undefined, { year: \"numeric\", month: \"short\", day: \"numeric\" });\n}\nfunction diffNightsISO(startISO, endISO) {\n  if (!startISO || !endISO) return 0;\n  const a = new Date(startISO);\n  const b = new Date(endISO);\n  const ms = b.setHours(0,0,0,0) - a.setHours(0,0,0,0);\n  return Math.max(0, Math.round(ms / (1000 * 60 * 60 * 24)));\n}\nfunction toTitleCaseStatus(s) {\n  const map = { PENDING: \"Pending\", ACCEPTED: \"Accepted\", CANCELLED: \"Cancelled\" };\n  return map[String(s || \"\").toUpperCase()] || \"Pending\";\n}\nfunction statusClass(s) {\n  switch (s) {\n    case \"Accepted\":  return \"badge text-bg-success\";\n    case \"Cancelled\": return \"badge text-bg-secondary\";\n    case \"Pending\":   return \"badge text-bg-warning\";\n    default:          return \"badge text-bg-light\";\n  }\n}\nfunction firstImage(photo_urls) {\n  if (!Array.isArray(photo_urls) || !photo_urls.length) return null;\n  const first = photo_urls[0];\n  return typeof first === \"string\" ? first : first?.url || null;\n}\nfunction imgSrc(url) {\n  if (!url) return \"https://via.placeholder.com/640x400?text=No+photo\";\n  return /^https?:\\/\\//i.test(url) ? url : `http://localhost:4000${url.startsWith(\"/\") ? url : `/${url}`}`;\n}\nfunction canCancel(status, checkinISO) {\n  const s = String(status);\n  if (s === \"Pending\") return true;\n  if (s === \"Accepted\") {\n    const today = new Date(); today.setHours(0,0,0,0);\n    const cin = new Date(checkinISO); cin.setHours(0,0,0,0);\n    return cin > today;\n  }\n  return false;\n}\n\nasync function fetchJSON(url, opts = {}, { onAuthFail } = {}) {\n  const res = await fetch(url, { credentials: \"include\", ...opts });\n  if (res.status === 401 || res.status === 403) {\n    try { localStorage.setItem(\"showLogin\", \"1\"); } catch {}\n    if (onAuthFail) onAuthFail();\n    throw new Error(\"Unauthorized\");\n  }\n  if (!res.ok) {\n    const data = await res.json().catch(() => ({}));\n    throw new Error(data.error || `Request failed (${res.status})`);\n  }\n  return res.json();\n}\n\nexport default function PastTrips() {\n  const nav = useNavigate();\n  const [items, setItems] = useState([]);  // normalized bookings\n  const [loading, setLoading] = useState(true);\n  const [err, setErr] = useState(\"\");\n  const [busy, setBusy] = useState({}); // { [bookingId]: true }\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const bookingsData = await fetchJSON(\n          \"http://localhost:4000/api/traveler/bookings\",\n          {},\n          { onAuthFail: () => nav(\"/\") }\n        );\n\n        const rows = Array.isArray(bookingsData)\n          ? bookingsData\n          : Array.isArray(bookingsData?.bookings)\n          ? bookingsData.bookings\n          : bookingsData\n          ? [bookingsData]\n          : [];\n\n        const enriched = await Promise.all(\n          rows.map(async (b) => {\n            let prop = null;\n            try {\n              const p = await fetchJSON(\n                `http://localhost:4000/api/properties/${b.property_id}`,\n                {},\n                { onAuthFail: () => nav(\"/\") }\n              );\n              prop = {\n                id: p.id,\n                name: p.title || \"Listing\",\n                price_per_night: p.price_per_night != null ? Number(p.price_per_night) : null,\n                image: firstImage(p.photo_urls),\n              };\n            } catch (_) {\n            }\n\n            const nights = diffNightsISO(b.start_date, b.end_date);\n            const price = prop?.price_per_night || 0;\n            const subtotal = nights * price;\n            const taxes = Math.round(subtotal * 0.0975 * 100) / 100;\n            const total = Math.round((subtotal + taxes) * 100) / 100;\n\n            return {\n              id: b.id,\n              property_id: b.property_id,\n              status: toTitleCaseStatus(b.status),\n              checkin: b.start_date,\n              checkout: b.end_date,\n              guests: Number(b.guests || 1),\n              nights,\n              total,\n              property: prop,\n            };\n          })\n        );\n\n        setItems(enriched);\n      } catch (e) {\n        setErr(e.message || \"Failed to load bookings\");\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, [nav]);\n\n  const hasTrips = useMemo(() => items.length > 0, [items]);\n\n  async function cancelBooking(id) {\n    setBusy((m) => ({ ...m, [id]: true }));\n    const prev = items;\n    // optimistic UI\n    setItems((list) => list.map((b) => (b.id === id ? { ...b, status: \"Cancelled\" } : b)));\n\n    try {\n      await fetchJSON(\n        `http://localhost:4000/api/traveler/bookings/${id}/cancel`,\n        { method: \"POST\", headers: { \"Content-Type\": \"application/json\" } },\n        { onAuthFail: () => nav(\"/\") }\n      );\n    } catch (e) {\n      // rollback\n      setItems(prev);\n      alert(e.message || \"Cancel failed\");\n    } finally {\n      setBusy((m) => {\n        const cpy = { ...m };\n        delete cpy[id];\n        return cpy;\n      });\n    }\n  }\n\n  if (loading) return <div className=\"text-muted\">Loading trips…</div>;\n  if (err) return <div className=\"alert alert-danger\">{err}</div>;\n  if (!hasTrips)\n    return (\n      <div className=\"text-center p-5 border rounded-4 bg-light-subtle\">\n        <h5 className=\"mb-2\">No trips yet</h5>\n        <p className=\"text-muted mb-3\">When you take a trip, it’ll appear here.</p>\n        <Link className=\"btn btn-dark rounded-pill px-4\" to=\"/\">Start exploring</Link>\n      </div>\n    );\n\n  return (\n    <div className=\"vstack gap-3\">\n      {items.map((b) => {\n        const p = b.property || {};\n        const img = imgSrc(p.image);\n        const cancellable = canCancel(b.status, b.checkin);\n        return (\n          <div key={b.id} className=\"card border-0 shadow-sm rounded-4\">\n            <div className=\"card-body\">\n              <div className=\"row g-3 align-items-center\">\n                <div className=\"col-auto\">\n                  <img\n                    src={img}\n                    alt={p.name}\n                    width=\"96\"\n                    height=\"96\"\n                    className=\"rounded-3\"\n                    style={{ objectFit: \"cover\" }}\n                  />\n                </div>\n\n                <div className=\"col\">\n                  <div className=\"d-flex align-items-center gap-2 flex-wrap\">\n                    <h6 className=\"mb-0\">{p.name || \"Listing\"}</h6>\n                    <span className={statusClass(b.status)}>{b.status}</span>\n                  </div>\n                  <div className=\"text-muted small mt-1\">\n                    {fmtDateISOToLocal(b.checkin)} – {fmtDateISOToLocal(b.checkout)}\n                    {\" · \"}\n                    {b.nights} night{b.nights > 1 ? \"s\" : \"\"}\n                    {\" · \"}\n                    {b.guests} guest{b.guests > 1 ? \"s\" : \"\"}\n                  </div>\n                </div>\n\n                <div className=\"col-auto text-end\">\n                  <div className=\"fw-semibold\">${b.total.toFixed(2)}</div>\n                  <div className=\"text-muted small\">Total</div>\n                  <div className=\"mt-2 d-flex gap-2 justify-content-end\">\n                    <Link\n                      className=\"btn btn-outline-secondary btn-sm rounded-pill\"\n                      to={`/property/${p.id}`}\n                    >\n                      View place\n                    </Link>\n\n                    {cancellable && (\n                      <button\n                        className=\"btn btn-outline-danger btn-sm rounded-pill\"\n                        disabled={!!busy[b.id]}\n                        onClick={() => cancelBooking(b.id)}\n                      >\n                        {busy[b.id] ? \"Cancelling…\" : \"Cancel\"}\n                      </button>\n                    )}\n                  </div>\n                </div>\n\n              </div>\n            </div>\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}